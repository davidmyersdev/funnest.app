import{r as e,o as t,c as n,a as s,w as o,F as i,b as a,d as c,e as r,v as l,f as h,g as d,h as m}from"./vendor.f37572c2.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const s=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,i)=>{const a=new URL(e,s);if(self[t].moduleMap[a])return n(self[t].moduleMap[a]);const c=new Blob([`import * as m from '${a}';`,`${t}.moduleMap['${a}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){i(new Error(`Failed to import: ${e}`)),o(r)},onload(){n(self[t].moduleMap[a]),o(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("/assets/");const u={},p={class:"navbar navbar-expand-lg navbar-light bg-light"},f={class:"container-fluid"},v=a("Fun"),w=a("Doodle");u.render=function(a,c){const r=e("router-link"),l=e("router-view");return t(),n(i,null,[s("nav",p,[s("div",f,[s(r,{to:"/",class:"navbar-brand"},{default:o((()=>[v])),_:1}),s(r,{to:"/doodle"},{default:o((()=>[w])),_:1})])]),s(l)],64)};const b=window.RTCPeerConnection||webkitRTCPeerConnection||mozRTCPeerConnection;class g{constructor(){this.connection=new b({iceServers:[{urls:["stun:stun.l.google.com:19302"]}]}),this.onOpen=()=>{},this.onMessage=()=>{},this.channel=null}send(e){this.channel&&this.channel.send(JSON.stringify(e))}createOffer(){return this.channel=this.connection.createDataChannel("main"),this.channel.onopen=this.onOpen,this.channel.onmessage=e=>{this.onMessage(JSON.parse(e.data))},new Promise(((e,t)=>{this.connection.createOffer().then((e=>{this.connection.setLocalDescription(e)})),this.connection.onicecandidate=t=>{null===t.candidate&&e(this.connection.localDescription)}}))}acceptOffer(e){const t=new RTCSessionDescription(e);return this.connection.ondatachannel=e=>{this.channel=e.channel,this.channel.onopen=this.onOpen,this.channel.onmessage=e=>{this.onMessage(JSON.parse(e.data))}},new Promise(((e,n)=>{this.connection.onicecandidate=t=>{null===t.candidate&&e(this.connection.localDescription)},this.connection.setRemoteDescription(t),this.connection.createAnswer().then((e=>{this.connection.setLocalDescription(e)})).catch(n)}))}acceptAnswer(e){this.connection.setRemoteDescription(new RTCSessionDescription(e))}}const x={data:()=>({p2p:null,myOffer:"",myAnswer:"",theirOffer:"",theirAnswer:"",starting:!1,join:!1,context:null}),methods:{createOffer(){this.p2p.createOffer().then((e=>{this.myOffer=btoa(JSON.stringify(e))}))},acceptOffer(){this.p2p.acceptOffer(JSON.parse(atob(this.theirOffer))).then((e=>{this.myAnswer=btoa(JSON.stringify(e))}))},acceptAnswer(){this.p2p.acceptAnswer(JSON.parse(atob(this.theirAnswer)))},startSession(){this.starting=!0,this.createOffer()},joinSession(){this.join=!0},acceptRequest(){this.acceptOffer()},onMessage(e){if(e)switch(e.message){case"start":this.start(e.value.x,e.value.y);break;case"move":this.move(e.value.x,e.value.y)}},start(e,t){this.context.moveTo(e,t),this.context.beginPath(),this.context.stroke()},startPeer(e,t){this.p2p.send({message:"start",value:{x:e,y:t}})},move(e,t){this.context.lineTo(e,t),this.context.stroke()},movePeer(e,t){this.p2p.send({message:"move",value:{x:e,y:t}})}},mounted(){this.p2p=new g,this.p2p.onMessage=this.onMessage;const e=e=>{const t=this.$refs.canvas.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]};this.context=this.$refs.canvas.getContext("2d");const t=t=>{const[n,s]=e(t);this.move(n,s),this.movePeer(n,s)};this.$refs.canvas.addEventListener("mousedown",(n=>{const[s,o]=e(n);this.start(s,o),this.startPeer(s,o),window.addEventListener("mousemove",t),window.addEventListener("mouseup",(()=>{window.removeEventListener("mousemove",t)}))}))}},y={class:"container"},O={key:0},C={key:1},S={class:"mb-3"},R=s("label",{class:"form-label"},"Your Request",-1),k=s("div",{class:"form-text"},"Send this to a friend.",-1),L={class:"mb-3"},A=s("label",{class:"form-label"},"Their Answer",-1),E=s("div",{class:"form-text"},"Get this from a friend.",-1),$={key:2},j={class:"mb-3"},P=s("label",{class:"form-label"},"Their Request",-1),T=s("div",{class:"form-text"},"Send this to a friend.",-1),U={class:"mb-3"},M=s("label",{class:"form-label"},"Your Answer",-1),D=s("div",{class:"form-text"},"Get this from a friend.",-1),z={ref:"canvas",width:"500",height:"500"};x.render=function(e,o,i,a,h,d){return t(),n("div",y,[h.starting||h.join?c("",!0):(t(),n("div",O,[s("button",{onClick:o[1]||(o[1]=(...e)=>d.startSession&&d.startSession(...e)),class:"btn btn-primary"},"Start Session"),s("button",{onClick:o[2]||(o[2]=(...e)=>d.joinSession&&d.joinSession(...e)),class:"btn btn-secondary ms-1"},"Join Session")])),h.starting?(t(),n("div",C,[s("div",S,[R,r(s("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>h.myOffer=e),type:"text",class:"form-control"},null,512),[[l,h.myOffer]]),k]),s("div",L,[A,r(s("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>h.theirAnswer=e),type:"text",class:"form-control"},null,512),[[l,h.theirAnswer]]),E]),s("button",{onClick:o[5]||(o[5]=(...e)=>d.acceptAnswer&&d.acceptAnswer(...e)),class:"btn btn-secondary ms-1"},"Accept Answer")])):c("",!0),h.join?(t(),n("div",$,[s("div",j,[P,r(s("input",{"onUpdate:modelValue":o[6]||(o[6]=e=>h.theirOffer=e),type:"text",class:"form-control"},null,512),[[l,h.theirOffer]]),T]),s("div",U,[M,r(s("input",{"onUpdate:modelValue":o[7]||(o[7]=e=>h.myAnswer=e),type:"text",class:"form-control"},null,512),[[l,h.myAnswer]]),D]),s("button",{onClick:o[8]||(o[8]=(...e)=>d.acceptRequest&&d.acceptRequest(...e)),class:"btn btn-secondary ms-1"},"Accept Request")])):c("",!0),s("canvas",z,null,512)])};const J={name:"Canvas",data:()=>({color:"#000000",context:null,lines:[],size:1,width:500,height:500}),computed:{lastLine(){return this.lines[this.lines.length-1]}},methods:{getCoords(e){const t=this.$refs.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},reset(){this.lines=[],this.clear()},clear(){this.context.clearRect(0,0,this.$refs.canvas.width,this.$refs.canvas.height)},drawLine(e){const[t,...n]=e.points;this.context.moveTo(t.x,t.y),this.context.lineWidth=e.size,this.context.strokeStyle=e.color,this.context.beginPath(),this.context.stroke(),n.forEach((e=>{this.context.lineTo(e.x,e.y),this.context.stroke()}))},repaint(){this.clear(),this.lines.forEach(this.drawLine)},undo(){this.lines=this.lines.slice(0,-1),this.repaint()}},mounted(){this.context=this.$refs.canvas.getContext("2d"),this.context.lineCap="round",this.width=this.$refs.canvas.parentElement.clientWidth,this.height=this.$refs.canvas.parentElement.clientHeight;const e=e=>{const t=this.getCoords(e);this.lastLine.points.push(t),this.context.lineTo(t.x,t.y),this.context.stroke()};this.$refs.canvas.addEventListener("mousedown",(t=>{const n=this.getCoords(t);this.lines.push({color:this.color,size:this.size,points:[n]}),this.context.moveTo(n.x,n.y),this.context.lineWidth=this.size,this.context.strokeStyle=this.color,this.context.beginPath(),this.context.stroke(),window.addEventListener("mousemove",e),window.addEventListener("mouseup",(()=>{window.removeEventListener("mousemove",e)}))}))}},N={class:"d-flex align-items-center justify-content-between my-3"};J.render=function(e,o,i,a,c,h){return t(),n("div",null,[s("div",N,[s("button",{onClick:o[1]||(o[1]=(...e)=>h.undo&&h.undo(...e)),class:"btn btn-sm btn-primary"},"Undo"),s("button",{onClick:o[2]||(o[2]=(...e)=>h.reset&&h.reset(...e)),class:"btn btn-sm btn-danger ms-1"},"Clear"),r(s("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>c.size=e),type:"range",min:"1",max:"10"},null,512),[[l,c.size]]),r(s("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>c.color=e),type:"color"},null,512),[[l,c.color]])]),s("canvas",{ref:"canvas",width:c.width,height:c.height},null,8,["width","height"])])};const q={class:"container"},V={expose:[],setup:e=>(e,o)=>(t(),n("div",q,[s(J)]))},_=h({history:d(),routes:[{path:"/",component:V},{path:"/doodle",component:x}]}),F=m(u);F.use(_),F.mount("#app");
