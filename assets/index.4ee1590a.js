import{r as t,o as e,c as n,a as s,w as i,F as o,b as a,d as r,e as c,v as l,f as h,g as d,h as u}from"./vendor.f37572c2.js";!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(n){const s=new URL(t,location),i=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((n,o)=>{const a=new URL(t,s);if(self[e].moduleMap[a])return n(self[e].moduleMap[a]);const r=new Blob([`import * as m from '${a}';`,`${e}.moduleMap['${a}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){o(new Error(`Failed to import: ${t}`)),i(c)},onload(){n(self[e].moduleMap[a]),i(c)}});document.head.appendChild(c)})),self[e].moduleMap={}}}("/assets/");const m={},p={class:"navbar navbar-expand-lg navbar-light bg-light"},f={class:"container-fluid"},v=a("Fun"),w=a("Doodle");m.render=function(a,r){const c=t("router-link"),l=t("router-view");return e(),n(o,null,[s("nav",p,[s("div",f,[s(c,{to:"/",class:"navbar-brand"},{default:i((()=>[v])),_:1}),s(c,{to:"/doodle"},{default:i((()=>[w])),_:1})])]),s(l)],64)};const g=window.RTCPeerConnection||webkitRTCPeerConnection||mozRTCPeerConnection;class b{constructor(){this.connection=new g({iceServers:[{urls:["stun:stun.l.google.com:19302"]}]}),this.onOpen=()=>{},this.onMessage=()=>{},this.channel=null}send(t){this.channel&&this.channel.send(JSON.stringify(t))}createOffer(){return this.channel=this.connection.createDataChannel("main"),this.channel.onopen=this.onOpen,this.channel.onmessage=t=>{this.onMessage(JSON.parse(t.data))},new Promise(((t,e)=>{this.connection.createOffer().then((t=>{this.connection.setLocalDescription(t)})),this.connection.onicecandidate=e=>{null===e.candidate&&t(this.connection.localDescription)}}))}acceptOffer(t){const e=new RTCSessionDescription(t);return this.connection.ondatachannel=t=>{this.channel=t.channel,this.channel.onopen=this.onOpen,this.channel.onmessage=t=>{this.onMessage(JSON.parse(t.data))}},new Promise(((t,n)=>{this.connection.onicecandidate=e=>{null===e.candidate&&t(this.connection.localDescription)},this.connection.setRemoteDescription(e),this.connection.createAnswer().then((t=>{this.connection.setLocalDescription(t)})).catch(n)}))}acceptAnswer(t){this.connection.setRemoteDescription(new RTCSessionDescription(t))}}const x={data:()=>({p2p:null,myOffer:"",myAnswer:"",theirOffer:"",theirAnswer:"",starting:!1,join:!1,context:null}),methods:{createOffer(){this.p2p.createOffer().then((t=>{this.myOffer=btoa(JSON.stringify(t))}))},acceptOffer(){this.p2p.acceptOffer(JSON.parse(atob(this.theirOffer))).then((t=>{this.myAnswer=btoa(JSON.stringify(t))}))},acceptAnswer(){this.p2p.acceptAnswer(JSON.parse(atob(this.theirAnswer)))},startSession(){this.starting=!0,this.createOffer()},joinSession(){this.join=!0},acceptRequest(){this.acceptOffer()},onMessage(t){if(t)switch(t.message){case"start":this.start(t.value.x,t.value.y);break;case"move":this.move(t.value.x,t.value.y)}},start(t,e){this.context.moveTo(t,e),this.context.beginPath(),this.context.stroke()},startPeer(t,e){this.p2p.send({message:"start",value:{x:t,y:e}})},move(t,e){this.context.lineTo(t,e),this.context.stroke()},movePeer(t,e){this.p2p.send({message:"move",value:{x:t,y:e}})}},mounted(){this.p2p=new b,this.p2p.onMessage=this.onMessage;const t=t=>{const e=this.$refs.canvas.getBoundingClientRect();return[t.clientX-e.left,t.clientY-e.top]};this.context=this.$refs.canvas.getContext("2d");const e=e=>{const[n,s]=t(e);this.move(n,s),this.movePeer(n,s)};this.$refs.canvas.addEventListener("mousedown",(n=>{const[s,i]=t(n);this.start(s,i),this.startPeer(s,i),window.addEventListener("mousemove",e),window.addEventListener("mouseup",(()=>{window.removeEventListener("mousemove",e)}))}))}},y={class:"container"},S={key:0},L={key:1},O={class:"mb-3"},C=s("label",{class:"form-label"},"Your Request",-1),R=s("div",{class:"form-text"},"Send this to a friend.",-1),P={class:"mb-3"},A=s("label",{class:"form-label"},"Their Answer",-1),E=s("div",{class:"form-text"},"Get this from a friend.",-1),k={key:2},z={class:"mb-3"},$=s("label",{class:"form-label"},"Their Request",-1),j=s("div",{class:"form-text"},"Send this to a friend.",-1),M={class:"mb-3"},U=s("label",{class:"form-label"},"Your Answer",-1),T=s("div",{class:"form-text"},"Get this from a friend.",-1),D={ref:"canvas",width:"500",height:"500"};x.render=function(t,i,o,a,h,d){return e(),n("div",y,[h.starting||h.join?r("",!0):(e(),n("div",S,[s("button",{onClick:i[1]||(i[1]=(...t)=>d.startSession&&d.startSession(...t)),class:"btn btn-primary"},"Start Session"),s("button",{onClick:i[2]||(i[2]=(...t)=>d.joinSession&&d.joinSession(...t)),class:"btn btn-secondary ms-1"},"Join Session")])),h.starting?(e(),n("div",L,[s("div",O,[C,c(s("input",{"onUpdate:modelValue":i[3]||(i[3]=t=>h.myOffer=t),type:"text",class:"form-control"},null,512),[[l,h.myOffer]]),R]),s("div",P,[A,c(s("input",{"onUpdate:modelValue":i[4]||(i[4]=t=>h.theirAnswer=t),type:"text",class:"form-control"},null,512),[[l,h.theirAnswer]]),E]),s("button",{onClick:i[5]||(i[5]=(...t)=>d.acceptAnswer&&d.acceptAnswer(...t)),class:"btn btn-secondary ms-1"},"Accept Answer")])):r("",!0),h.join?(e(),n("div",k,[s("div",z,[$,c(s("input",{"onUpdate:modelValue":i[6]||(i[6]=t=>h.theirOffer=t),type:"text",class:"form-control"},null,512),[[l,h.theirOffer]]),j]),s("div",M,[U,c(s("input",{"onUpdate:modelValue":i[7]||(i[7]=t=>h.myAnswer=t),type:"text",class:"form-control"},null,512),[[l,h.myAnswer]]),T]),s("button",{onClick:i[8]||(i[8]=(...t)=>d.acceptRequest&&d.acceptRequest(...t)),class:"btn btn-secondary ms-1"},"Accept Request")])):r("",!0),s("canvas",D,null,512)])};const F={name:"Canvas",data:()=>({color:"#000000",context:null,lines:[],size:1,width:500,height:500}),computed:{lastLine(){return this.lines[this.lines.length-1]},lastPoint(){return this.lastLine.points[this.lastLine.points.length-1]}},methods:{getCoords(t){const e=this.$refs.canvas.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},reset(){this.lines=[],this.clear()},clear(){this.context.clearRect(0,0,this.$refs.canvas.width,this.$refs.canvas.height)},drawLine(t){const[e,...n]=t.points,s=n.pop();this.drawStart(e,{size:t.size,color:t.color}),n.forEach(this.drawSeg),this.drawFinal(s,{size:t.size})},repaint(){this.clear(),this.lines.forEach(this.drawLine)},undo(){this.lines=this.lines.slice(0,-1),this.repaint()},addLine(t){this.lines.push({color:this.color,size:this.size,points:[t]}),this.drawStart(t,{size:this.size,color:this.color})},addSeg(t){this.lastLine.points.push(t),this.drawSeg(t)},addFinal(t){this.lastLine.points.push(t),this.drawFinal(t,{size:this.size})},drawSeg(t){this.context.lineTo(t.x,t.y),this.context.stroke()},drawStart(t,{size:e,color:n}){this.context.lineWidth=e,this.context.strokeStyle=n,this.context.fillStyle=n,this.context.moveTo(t.x,t.y),this.context.beginPath(),this.context.arc(t.x,t.y,e/2,0,2*Math.PI),this.context.closePath(),this.context.fill(),this.context.beginPath(),this.context.stroke()},drawFinal(t,{size:e}){this.context.lineTo(t.x,t.y),this.context.beginPath(),this.context.arc(t.x,t.y,e/2,0,2*Math.PI),this.context.closePath(),this.context.fill()}},mounted(){this.context=this.$refs.canvas.getContext("2d"),this.context.lineCap="round",this.context.translate(.5,.5),this.width=this.$refs.canvas.parentElement.clientWidth,this.height=this.$refs.canvas.parentElement.clientHeight;const t=t=>{const e=this.getCoords(t);this.addSeg(e)},e=t=>{if(1===t.touches.length){const e=this.getCoords(t.touches[0]);this.addSeg(e)}},n=t=>{const s=this.lastPoint;this.addFinal(s),window.removeEventListener("touchmove",e),window.removeEventListener("touchend",n)};this.$refs.canvas.addEventListener("mousedown",(e=>{const n=this.getCoords(e);this.addLine(n),window.addEventListener("mousemove",t),window.addEventListener("mouseup",(()=>{window.removeEventListener("mousemove",t)}))})),this.$refs.canvas.addEventListener("touchstart",(t=>{if(t.preventDefault(),1===t.touches.length){const s=this.getCoords(t.touches[0]);this.addLine(s),window.addEventListener("touchmove",e),window.addEventListener("touchend",n)}}))}},J={class:"d-flex align-items-center justify-content-between my-3"};F.render=function(t,i,o,a,r,h){return e(),n("div",null,[s("div",J,[s("button",{onClick:i[1]||(i[1]=(...t)=>h.undo&&h.undo(...t)),class:"btn btn-sm btn-primary"},"Undo"),s("button",{onClick:i[2]||(i[2]=(...t)=>h.reset&&h.reset(...t)),class:"btn btn-sm btn-danger ms-1"},"Clear"),c(s("input",{"onUpdate:modelValue":i[3]||(i[3]=t=>r.size=t),type:"range",min:"1",max:"10"},null,512),[[l,r.size]]),c(s("input",{"onUpdate:modelValue":i[4]||(i[4]=t=>r.color=t),type:"color"},null,512),[[l,r.color]])]),s("canvas",{ref:"canvas",width:r.width,height:r.height},null,8,["width","height"])])};const N={class:"container"},q={expose:[],setup:t=>(t,i)=>(e(),n("div",N,[s(F)]))},V=h({history:d(),routes:[{path:"/",component:q},{path:"/doodle",component:x}]}),_=u(m);_.use(V),_.mount("#app");
